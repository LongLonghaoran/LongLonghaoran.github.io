<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.4.17 (463232)"/><meta name="author" content="过眼云烟"/><meta name="created" content="2022-06-20 14:16:17 +0000"/><meta name="source" content="desktop.win"/><meta name="source-application" content="yinxiang.win32"/><meta name="updated" content="2022-06-28 09:31:56 +0000"/><title>build-web-application-with-golang笔记</title></head><body><div>2.go语言基础:</div><div>25个关键字:</div><div>break default func interface select</div><div>case defer go map struct</div><div>chan else goto package switch</div><div>const fallthrough if range type</div><div>continue for import return var</div><div><br/></div><div>new和make:</div><div>new(T)返回的是指向T类型值的指针</div><div>make(T, args)返回的是T类型的值本身,make只能用于slice map chan三种类型</div><div><img src="build-web-application-with-golang%E7%AC%94%E8%AE%B0.resources/A52B9E3B-893C-4464-B574-E348357C88F5.png" height="102" width="536"/><br/></div><div><br/></div><div>流程跳转:</div><div>goto语句：可以跳转到当前函数内指定标签的语句处</div><div><br/></div><div>defer延迟调用,defer后的语句会在函数推出前调用，如果有多个defer，那么按照后进先出的顺序调用</div><div>defer后面必须跟一个函数调用</div><div><br/></div><div>panic和recover:</div><div>go语言没有异常机制,   使用的是panic和recover机制</div><div>调用panic或者程序自身发生异常时会使当前协程进入panic状态，并会一层一层地通过函数向外层抛</div><div>通过在defer后面函数调用recover可是协程恢复</div><div><br/></div><div>3.http包</div><div><br/></div><div>4.表单:</div><div>    1.html/template包可以解析html模板文件,返回html页面,t, _ := template.parseFile(文件路径),t.execute()</div><div>    2.接收form提交数据需要r.parseForm()</div><div>    3.对于用户输入应该使用template.HTMLEscape进行输出,转义后操作,防止xss</div><div>    4.防止重复提交表单一般有两种办法,对于form提交,应该在表单中加入唯一token,服务端处理提交的时候校验token,token合法的话就清除该token那么下一个重复的提交就因为token不合法无效了;对于ajax提交,自行禁用</div><div><br/></div><div>5.访问数据库</div><div>    1.只要使用实现了相同接口比如database/sql的数据库驱动来开发,那么使用方式几乎一样,只有连接字符串和postgres中部分特有特性不一样,mysql驱动推荐使用<a href="https://github.com/go-sql-driver/mysql" style="box-sizing: border-box; background-color: rgb(255, 255, 255); font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: var(--color-accent-fg); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal; text-decoration: underline;">https://github.com/go-sql-driver/mysql</a><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;"> </span> 完全符合database/sql接口</div><div><br/></div><div><br/></div><div>7.文本处理:</div><div>    xml:略，完全看不懂他写的啥，前言不搭后语</div><div><br/></div><div>    json:使用json包的Unmarshal函数解析,使用marshal将struct数据转换为json</div><div>    这里输出数据到终端的时候都是使用os.StdOut.write，如果使用fmt.println的话只会输出二进制编码数值</div><div>    有一个包叫GoSimpleJson是用于处理json字符串转换的，比较简单方便</div><div>    </div><div>    正则处理regexp</div><div>    通过regexp包处理，先使用regexp.Compile("正则表达式")生成正则表达式</div><div>    然后通过返回的regexp对象，调用匹配方法使用：</div><div>    匹配方法有FindString FindAll Match MatchString等</div><div><br/></div><div>    模板处理: api开发暂时用不到先略过</div><div><br/></div><div>    文件处理:</div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">文件操作的大多数函数都是在os包里面</span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">    比如 os.Mkdir os.MkdirAll os.Remove os.RemoveAll</span></div><div><br/></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">    字符串处理：</span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">        主要涉及两个包strings </span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">strconv</span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">        </span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">8.web服务</span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">    socket编程:</span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">        客户端需要net.tcpConn, tcp.tcpAddr,建立连接使用</span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">        net.DialTCP("tcp", nil, tcpaddr)</span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">        服务端使用tcpconn.Listen然后使用tcpconn.accept</span></div><div><br/></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">    websocket:</span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">        服务器只需握手过后就可以保持长连接，服务端可以push信息到客户端</span></div><div>        创建服务很简单 http.Handle("/", websocket.Handler(自定义处理函数))</div><div>        http.ListenAndServe(":1234", nil)就可以在该端口1234监听socket连接了</div><div><br/></div><div>    REST:简单的介绍了一下什么是REST</div><div><br/></div><div>    RPC:</div><div>        Remote Procedure Call 远端过程调用，目标是实现函数调用的</div><div>        网络化</div><div>           <span style="background-color: rgb(255, 255, 255); font-size: 16px;"><span style="box-sizing: border-box; font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;-en-paragraph:true;">Go标准包中已经提供了对RPC的支持，而且支持三个级别的RPC：TCP、HTTP、JSONRPC。但Go的RPC包是独一无二的RPC，它和传统的RPC系统不同，它只支持Go开发的服务器与客户端之间的交互，因为在内部，它们采用了Gob来编码。
</span></span></div><div>    GO RPC函数要求:</div><div><br/></div><div>    </div><ul style="box-sizing: border-box; padding-left: 2em; font-size: 16px; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><li style="box-sizing: border-box;"><div><span style="font-size: 16px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">函数必须是导出的(首字母大写)</span></div></li><li style="box-sizing: border-box;"><div><span style="font-size: 16px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">必须有两个导出类型的参数，</span></div></li><li style="box-sizing: border-box;"><div><span style="font-size: 16px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">第一个参数是接收的参数，第二个参数是返回给客户端的参数，第二个参数必须是指针类型的</span></div></li><li style="box-sizing: border-box;"><div><span style="font-size: 16px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">函数还要有一个返回值error</span></div></li></ul><div><br/></div><div>9.安全与加密</div><div><br/></div><div>12.部署</div><div>    日志: logrus使用方便, seelog支持强大配置，复杂日志</div><div>    错误处理:go语言的标准库和第三包中应该做到如果有可能发生可预知的错误，那么函数和方法应该自身返回error信息，如果是不可预知的错误，那么会发生panic，panic会当前执行代码的goroutine中断执行，在发生异常的代码之后的代码都不会继续执行了，这个情况就需要通过recover来恢复程序执行</div><div>    部署: 目前go还不支持daemon方式运行?可以使用第三方工具supervisord来管理进程</div><div>    数据库备份:mysql用mysqldump+crontab备份，还原用source xx.sql</div><div><br/></div><div>13.如何设计一个web框架</div><div><span>    beego框架对于前端的支持还很原始，略过</span><br/></div><div>    </div></body></html>