<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.4.17 (463232)"/><meta name="altitude" content="112.4822540283203"/><meta name="author" content="过眼云烟"/><meta name="created" content="2022-06-14 13:38:17 +0000"/><meta name="latitude" content="28.28170776367188"/><meta name="longitude" content="112.9241647211114"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2022-06-15 08:19:02 +0000"/><title>使用Go Modules</title></head><body><div>go的模块功能从1.11版本开始启用,之后每个版本都会发生变动,目前最新版本是1.18</div><div><br/></div><div>module(模块)是存放在文件树中的go包的集合,其根目录存放一个go.mod文件</div><div>go.mod文件定义的模块的module path，这也是根目录的导入路径</div><div>以及它的依赖（其它模块需要用以构建）。每个依赖都是用模块路径</div><div>和语义版本书写。</div><div>Go 1.11版本的时候，go命令会在当前目录或者父级目录有go.mod文件的时候启用</div><div>module模式，只要是在$GOPATH/src目录之外（所以我们的kregistry项目完全不</div><div>需要在$GOPATH/src目录下）（在$GOPATH/src下时，为了兼容性考虑，go命令仍然</div><div>使用老的GOPATH模式运行）从1.13开始，module模式会是开发模式的默认选项</div><div>1.16之后GO111MODULE默认设置为on</div><div><br/></div><div>以下介绍一些module模式下的常用操作:</div><div>创建模块</div><div>1.在$GOPATH之外创建一个目录，这个作为我们要建立的模块的目录</div><div>2.写一个 xxx.go文件，文件第一行以 pakcage 模块名 开始，在该目录下的所有文件</div><div>都是属于同一个模块的，开头都是以 package 模块名 开始</div><div>3.初始化 go mod init 域名/模块名, 必须得是这种格式,这是go module要求</div><div>4.执行 go mod tidy会自动安装该模块所需的依赖(如果在代码中的有使用import引入</div><div>非标准库的包的话)</div><div><br/></div><div>添加依赖</div><div>直接在代码中使用import导入外部模块,然后 go mod tidy即会自动安装</div><div>添加依赖过多的话也是有一定风险的:<a href="https://research.swtch.com/deps">https://research.swtch.com/deps</a></div><div><br/></div><div>go.sum</div><div>除了go.mod文件,go mod tidy还会生成一个go.sum文件，该文件就是所有依赖文件</div><div>计算生成的hash,用以确保包未来在下载这些包的时候还是相同的包，go.mod和go.sum</div><div>都应该加入到版本控制去</div><div><br/></div><div>查看依赖:</div><div>添加一个依赖往往会带来其它间接依赖，可以通过 go list -m all lie出当前模块所有依赖</div><div><br/></div><div>更新依赖</div><div>通过使用 go get 模块名 来获取最新版版的该模块</div><div><br/></div><div>更新到指定版本的依赖</div><div>go get 模块名@版本</div><div>go get rsc.io/sampler@v1.3.1</div><div><br/></div><div>在新的主版本之上添加一个依赖</div><div>更新依赖至一个新的主版本</div><div>移除不用的依赖</div></body></html>